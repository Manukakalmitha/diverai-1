chrome.action.onClicked.addListener(r=>{chrome.sidePanel.open({tabId:r.id})});chrome.runtime.onMessage.addListener((r,a,e)=>{if(r.action==="OPEN_SIDEBAR")chrome.sidePanel.open({tabId:a.tab.id}),e({status:"opening"});else if(r.action==="CAPTURE_SCREENSHOT")return chrome.tabs.captureVisibleTab(null,{format:"jpeg",quality:50},t=>{chrome.runtime.lastError?(console.error(chrome.runtime.lastError),e({error:chrome.runtime.lastError.message})):e({dataUrl:t})}),!0});
